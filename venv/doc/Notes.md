#Keras
##使用Keras构建深度学习模型的步骤：
- 定义模型----创建一个序贯模型并添加配置层
- 编译模型----指定损失函数和优化器，并调用模型的compile（）函数，完成模型编译
- 训练模型----通过调用模型的fit（）函数来训练模型
- 执行预测----调用模型的evaluate（）或predict（）等函数对新数据进行预测
> 序贯模型（Sequential）：多个网络层的线性堆叠
##多层感知器实例-印第安人糖尿病诊断
1. 导入数据
2. 定义模型
   - 模型被定义为层序列，本例使用三层完全连接的网络结构，Keras中通常用Dense类来定义完全连接的层，Dense参数：神经元数量（unit）、初始化方法（init）、指定激活函数（activation）、input_dim参数指定输入变量数。
3. 编译模型
   - 指定用于评估一组权重的损失函数（loss）、用于搜索网络不同权重的优化器（optimizer），这里使用有效的梯度下降算法Adam作为优化器，由于是分类问题，采用分类准确度作为度量模型的标准。
4. 训练模型
   - epochs参数，对数据集进行固定次数的迭代，并且使用相对较小的batch_size参数，这些参数最好通过多次试验获得。
5. 评估模型
6. 汇总代码
##多层感知器速成
- 人工神经网络，通称神经网络、多层感知器，常用来解决分类和回归问题，一种前反馈人工神经网络模型，将输入的多个数据维度映射到单一的输出的数据维度上。
- 神经元，是构成神经网络的基本模块，其模型是一个具有加权输入，并且使用激活功能产生输出信号的基础计算单元。
- 权重和偏差：偏差是改善学习速度和预防过拟合的有效方法。权重通常被初始化为小的随机值。
- 激活函数：加权输入与神经元输出的简单映射，它控制神经元激活的阈值和输出信号的强度。
   - 非线性
   - 可微性：必须
   - 单调性
   - f（x）≈x
   - 输出值的范围

- 常用的激活函数：类似逻辑函数的非线性函数：sigmoid函数，双曲正切函数：tanh，线性整流函数：ReLU
- 神经网络：
   - 输入层和输出层的节点数往往是固定的，中间层（隐藏层）可以自由指定。
   - 拓扑和箭头代表预测过程中数据的流向，和训练时的数据流有一定的区别。
   - 结构图中的连接线是关键，每个连接线对应一个不同的权重，这需要训练得到。
   - 输入层（可视层）：每个输入维度或列具有一个神经元，作用仅仅是将输入值传递给下一层。
   - 隐藏层：理论证明两层神经网络可以无限逼近任意连续函数，隐藏层对原始数据进行了一个空间变换，使其可以被线性分类。输出层的决策分界画出了一个线性分类分界线，对其进行分类。多层的神经网络的本质就是复杂函数的拟合。
   - 输出层：也称最后的隐藏层，负责输出与项目问题所需格式相对应的值或向量。输出层中激活功能的选择受建模问题类型的强烈约束。
   - 设计一个神经网络时，输入层的节点数需要与特征的维度匹配，输出层的节点数要与目标的维度匹配。
   - 中间层的节点数要根据最终效果来决定。
- 随机梯度下降算法：经典有效的神经网络优化算法，是随机和优化相结合的产物，是用于大规模问题。采用迭代的策略，找到局部最优解，对于凸优化问题，可以得到全局最优解。随机梯度下降可以降低在深度学习的巨大数据量下普通梯度下降的巨大计算开销。其思想是，不直接计算梯度的精确值，而是用梯度的无偏估计来代替梯度，使得数据快速收敛。
   - 向前传播：输入通过神经元的激活函数，一直传递到输出。
   - 反向传播：首先将网络的输出与预期输出进行比较，并计算出错误，然后该错误通过网络一次（依次）传播回来，并根据它们对错误的贡献量更新权重。
   - 时期（epoch）：整个训练数据集的一轮更新网络。
- 权重更新
   - 通常使用少量样本对权重进行更新，也就是说设置一个相对较小的批处理大小（batch_size）
   - 动量（Momentum）
   - 学习率衰减（Learning Rate Decay）

- 预测新数据
   - 单层神经网络中sgn激活函数，两层：sigmoid激活函数，多层神经网络中，ReLU更容易收敛，并且预测性更好。
   - ReLU，不是传统非线性函数，是分段线性函数，表达为y=max（x，0）
   - 在多层神经网络中，训练的主题是优化和泛化。
   - 深度学习中由于层数增加了，参数也增加了，表示能力大幅增强，容易过拟合，正则化很重要。
##评估深度学习模型
- 两种评估方法：自动评估、手动评估
- 自动评估：fit()函数每次epoch会自动评估，也可以设置validation_split这个参数根据数据集百分比来进行评估，比如设置0.2，就使用20%数据集开始测试。
- 手动评估
   - 手动分离数据集并评估：也可以用scikit机器学习库的train_test_split()函数把数据分成训练数据集和评估数据集。但评估数据集可以通过评估参数传递给Keras的fit()函数。
   - K折交叉验证：sk_Learn中有StratifiedKFord可以用。
##在Keras中使用Scikit_Learn







